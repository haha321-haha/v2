# Pre-commit hook configuration for zero-hardcode development
# 基于Pain Pattern和压力管理项目的成功经验

repos:
  # 基础代码质量检查
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v4.4.0
    hooks:
      - id: trailing-whitespace
        exclude: '.*\.(md|json)$'
      - id: end-of-file-fixer
        exclude: '.*\.(md|json)$'
      - id: check-yaml
        args: ['--unsafe']
      - id: check-json
      - id: check-merge-conflict
      - id: check-added-large-files
        args: ['--maxkb=1000']
        exclude: '^public/downloads/.*\.pdf$'  # 允许下载目录下的 PDF 文件超过 1000 KB

  # ESLint检查
  - repo: https://github.com/pre-commit/mirrors-eslint
    rev: v8.55.0
    hooks:
      - id: eslint
        files: \.(js|jsx|ts|tsx)$
        exclude: '^scripts/|^eslint-rules/'
        additional_dependencies:
          - eslint@^8.55.0
          - '@typescript-eslint/eslint-plugin@^6.0.0'
          - '@typescript-eslint/parser@^6.0.0'

  # 自定义硬编码检测（暂时禁用，脚本不存在）
  # - repo: local
  #   hooks:
  #     - id: detect-hardcode
  #       name: 'Detect Hardcoded Strings'
  #       entry: bash -c 'npm run detect-hardcode || (echo "❌ 硬编码检测失败！请修复后再提交。" && exit 1)'
  #       language: system
  #       files: \.(js|jsx|ts|tsx)$
  #       exclude: '^scripts/|^eslint-rules/'
  #       pass_filenames: false

  #     - id: detect-stress-hardcode
  #       name: 'Detect Stress Management Hardcode'
  #       entry: bash -c 'npm run detect-stress-hardcode || (echo "❌ 压力管理项目硬编码检测失败！请修复后再提交。" && exit 1)'
  #       language: system
  #       files: '^app/\[locale\]/stress-management/|^components/stress-management/'
  #       pass_filenames: false

  # TypeScript类型检查
  - repo: https://github.com/pre-commit/mirrors-prettier
    rev: v3.1.0
    hooks:
      - id: prettier
        files: \.(js|jsx|ts|tsx|json|md)$
        exclude: '^scripts/|^eslint-rules/'

# 全局配置
default_stages: [pre-commit]
fail_fast: false
